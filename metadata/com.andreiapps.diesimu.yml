Categories:
  - Games
License: GPL-3.0-only
AuthorName: Andrei Apps
AuthorEmail: andreiacatrini712@gmail.com
AuthorWebSite: https://andreiapps.github.io
WebSite: https://andreiapps.github.io/apps.html#die-simulator
SourceCode: https://github.com/andreiapps/die_simulator
IssueTracker: https://github.com/andreiapps/die_simulator/issues

RepoType: git
Repo: https://github.com/andreiapps/die_simulator.git

Builds:
  - versionName: '1.0'
    versionCode: 1
    commit: v1.0
    sudo:
      - apt-get update
      - apt-get install zip unzip
      - apt-get install -y g++ libc-dev make automake libltdl-dev libtool zlib1g-dev
        libffi-dev libssl-dev cython3
      - apt-get install -y python3-pip python3-pexpect python3-virtualenv python3-sh
      - apt-get install -y -t bookworm-backports python3-appdirs python3-colorama
        python3-jinja2 python3-build python3-toml python3-packaging
      - apt-get install -y ant
      - rm /opt/android-sdk/tools/bin/sdkmanager
      - ln -s $(which sdkmanager) /opt/android-sdk/tools/bin/sdkmanager
      - echo -e '#!/usr/bin/sh\nls /opt/android-sdk/platforms | sed "s/android-/API
        level:\ /g"' > /opt/android-sdk/tools/bin/avdmanager
      - chmod +x /opt/android-sdk/tools/bin/avdmanager
    output: bin/*.apk
    srclibs:
      - cpython@v3.8.18
      - python-for-android@v2023.09.16
      - buildozer@1.5.0
    prebuild:
      - sdkmanager 'platforms;android-33' 'build-tools;33.0.0'
      - sed -i -e 's/log_level =.*/log_level = 1/' -e '/^\[app\]/aandroid.ndk_path
        = $$NDK$$\nandroid.sdk_path = $$SDK$$\nandroid.skip_update = True\np4a.source_dir
        = $$python-for-android$$\nandroid.ant_path = /usr' buildozer.spec
    build:
      - pushd $$cpython$$
      - ./configure --prefix=$HOME/.local
      - make -j`nproc`
      - make altinstall
      - popd
      - pip3 config set global.break-system-packages true
      - pip3 install $$buildozer$$
      - ln -s $(which cython3) /home/vagrant/.local/bin/cython
      - export PATH="$PATH:$HOME/.local/bin"
      - APP_ANDROID_ARCH=arm64-v8a APP_ANDROID_NUMERIC_VERSION=$$VERCODE$$ buildozer
        android release
    ndk: r25b

  - versionName: '1.0'
    versionCode: 2
    commit: 0d9d58a37e8a2753367c79df12d0a83663645268
    sudo:
      - apt-get update
      - apt-get install zip unzip
      - apt-get install -y g++ libc-dev make automake libltdl-dev libtool zlib1g-dev
        libffi-dev libssl-dev cython3
      - apt-get install -y python3-pip python3-pexpect python3-virtualenv python3-sh
      - apt-get install -y -t bookworm-backports python3-appdirs python3-colorama
        python3-jinja2 python3-build python3-toml python3-packaging
      - apt-get install -y ant
      - rm /opt/android-sdk/tools/bin/sdkmanager
      - ln -s $(which sdkmanager) /opt/android-sdk/tools/bin/sdkmanager
      - echo -e '#!/usr/bin/sh\nls /opt/android-sdk/platforms | sed "s/android-/API
        level:\ /g"' > /opt/android-sdk/tools/bin/avdmanager
      - chmod +x /opt/android-sdk/tools/bin/avdmanager
    output: bin/*.apk
    srclibs:
      - cpython@v3.8.18
      - python-for-android@v2023.09.16
      - buildozer@1.5.0
    prebuild:
      - sdkmanager 'platforms;android-33' 'build-tools;33.0.0'
      - sed -i -e 's/log_level =.*/log_level = 1/' -e '/^\[app\]/aandroid.ndk_path
        = $$NDK$$\nandroid.sdk_path = $$SDK$$\nandroid.skip_update = True\np4a.source_dir
        = $$python-for-android$$\nandroid.ant_path = /usr' buildozer.spec
    build:
      - pushd $$cpython$$
      - ./configure --prefix=$HOME/.local
      - make -j`nproc`
      - make altinstall
      - popd
      - pip3 config set global.break-system-packages true
      - pip3 install $$buildozer$$
      - ln -s $(which cython3) /home/vagrant/.local/bin/cython
      - export PATH="$PATH:$HOME/.local/bin"
      - APP_ANDROID_ARCH=arm64-v8a APP_ANDROID_NUMERIC_VERSION=$$VERCODE$$ buildozer
        android release
    ndk: r25b

AutoUpdateMode: Version
UpdateCheckMode: Tags
UpdateCheckData: buildozer.spec|android.numeric_version\s*=\s*(\d+)|.|version\s*=\s*([\d.]+)
CurrentVersion: '1.0'
CurrentVersionCode: 2
