Categories:
  - Internet
  - Sports & Health
  - Workout
License: AGPL-3.0-only
AuthorName: Christian Flaßkamp
AuthorEmail: compete@flasskamp.com
SourceCode: https://codeberg.org/epinez/Compete
IssueTracker: https://codeberg.org/epinez/Compete/issues
Liberapay: epinez
Bitcoin: 35DcbAwi66LDyvxfpmvxVrM7nYrrZVC59k

AutoName: Compete

RepoType: git
Repo: https://codeberg.org/epinez/Compete.git

Builds:
  - versionName: 1.0.2
    versionCode: 31
    commit: v1.0.2
    subdir: app
    submodules: true
    sudo:
      - mkdir -p /home/christian
      - chown vagrant /home/christian
    output: build/app/outputs/flutter-apk/app-armeabi-v7a-release.apk
    binary: https://codeberg.org/epinez/Compete/releases/download/v%v/app-armeabi-v7a-release.apk
    rm:
      - app/ios
      - app/web
      - app/linux
      - app/macos
      - app/windows
      - backend
    prebuild:
      - export ORIGINAL_REPO_PATH=/home/christian/Development/Codeberg
      - mkdir -p $ORIGINAL_REPO_PATH
      - cd ../..
      - mv com.flasskamp.compete $ORIGINAL_REPO_PATH/Compete
      - pushd $ORIGINAL_REPO_PATH/Compete/app
      - export PUB_CACHE=$(pwd)/.pub-cache
      - ../submodules/flutter/bin/flutter config --no-analytics
      - ../submodules/flutter/bin/flutter pub get
      - popd
      - mv $ORIGINAL_REPO_PATH/Compete com.flasskamp.compete
    scanignore:
      - submodules/flutter/bin/cache
      - submodules/flutter/packages/flutter/pubspec.yaml
      - submodules/flutter/packages/flutter_localizations/pubspec.yaml
      - submodules/flutter/packages/flutter_test/pubspec.yaml
      - submodules/flutter/packages/flutter_web_plugins/pubspec.yaml
    scandelete:
      - submodules/flutter
      - app/.pub-cache
    build:
      - export ORIGINAL_REPO_PATH=/home/christian/Development/Codeberg
      - cd ../..
      - mv com.flasskamp.compete $ORIGINAL_REPO_PATH/Compete
      - pushd $ORIGINAL_REPO_PATH/Compete/app
      - export PUB_CACHE=$(pwd)/.pub-cache
      - echo "APP_NAME='Compete'" > assets/.env
      - echo "APP_ID='com.flasskamp.compete'" >> assets/.env
      - echo "DEVELOPER_NAME='Christian Flaßkamp'" >> assets/.env
      - echo "REPO_URL='https://codeberg.org/epinez/Compete'" >> assets/.env
      - echo "ISSUE_URL='https://codeberg.org/epinez/Compete/issues'" >> assets/.env
      - echo "CONTACT_EMAIL='compete@flasskamp.com'" >> assets/.env
      - ../submodules/flutter/bin/dart run build_runner build --delete-conflicting-outputs
      - ../submodules/flutter/bin/flutter build apk --split-per-abi --target-platform="android-arm"
      - popd
      - mv $ORIGINAL_REPO_PATH/Compete com.flasskamp.compete

  - versionName: 1.0.2
    versionCode: 32
    commit: v1.0.2
    subdir: app
    submodules: true
    sudo:
      - mkdir -p /home/christian
      - chown vagrant /home/christian
    output: build/app/outputs/flutter-apk/app-arm64-v8a-release.apk
    binary: https://codeberg.org/epinez/Compete/releases/download/v%v/app-arm64-v8a-release.apk
    rm:
      - app/ios
      - app/web
      - app/linux
      - app/macos
      - app/windows
      - backend
    prebuild:
      - export ORIGINAL_REPO_PATH=/home/christian/Development/Codeberg
      - mkdir -p $ORIGINAL_REPO_PATH
      - cd ../..
      - mv com.flasskamp.compete $ORIGINAL_REPO_PATH/Compete
      - pushd $ORIGINAL_REPO_PATH/Compete/app
      - export PUB_CACHE=$(pwd)/.pub-cache
      - ../submodules/flutter/bin/flutter config --no-analytics
      - ../submodules/flutter/bin/flutter pub get
      - popd
      - mv $ORIGINAL_REPO_PATH/Compete com.flasskamp.compete
    scanignore:
      - submodules/flutter/bin/cache
      - submodules/flutter/packages/flutter/pubspec.yaml
      - submodules/flutter/packages/flutter_localizations/pubspec.yaml
      - submodules/flutter/packages/flutter_test/pubspec.yaml
      - submodules/flutter/packages/flutter_web_plugins/pubspec.yaml
    scandelete:
      - submodules/flutter
      - app/.pub-cache
    build:
      - export ORIGINAL_REPO_PATH=/home/christian/Development/Codeberg
      - cd ../..
      - mv com.flasskamp.compete $ORIGINAL_REPO_PATH/Compete
      - pushd $ORIGINAL_REPO_PATH/Compete/app
      - export PUB_CACHE=$(pwd)/.pub-cache
      - echo "APP_NAME='Compete'" > assets/.env
      - echo "APP_ID='com.flasskamp.compete'" >> assets/.env
      - echo "DEVELOPER_NAME='Christian Flaßkamp'" >> assets/.env
      - echo "REPO_URL='https://codeberg.org/epinez/Compete'" >> assets/.env
      - echo "ISSUE_URL='https://codeberg.org/epinez/Compete/issues'" >> assets/.env
      - echo "CONTACT_EMAIL='compete@flasskamp.com'" >> assets/.env
      - ../submodules/flutter/bin/dart run build_runner build --delete-conflicting-outputs
      - ../submodules/flutter/bin/flutter build apk --split-per-abi --target-platform="android-arm64"
      - popd
      - mv $ORIGINAL_REPO_PATH/Compete com.flasskamp.compete

  - versionName: 1.0.2
    versionCode: 33
    commit: v1.0.2
    subdir: app
    submodules: true
    sudo:
      - mkdir -p /home/christian
      - chown vagrant /home/christian
    output: build/app/outputs/flutter-apk/app-x86_64-release.apk
    binary: https://codeberg.org/epinez/Compete/releases/download/v%v/app-x86_64-release.apk
    rm:
      - app/ios
      - app/web
      - app/linux
      - app/macos
      - app/windows
      - backend
    prebuild:
      - export ORIGINAL_REPO_PATH=/home/christian/Development/Codeberg
      - mkdir -p $ORIGINAL_REPO_PATH
      - cd ../..
      - mv com.flasskamp.compete $ORIGINAL_REPO_PATH/Compete
      - pushd $ORIGINAL_REPO_PATH/Compete/app
      - export PUB_CACHE=$(pwd)/.pub-cache
      - ../submodules/flutter/bin/flutter config --no-analytics
      - ../submodules/flutter/bin/flutter pub get
      - popd
      - mv $ORIGINAL_REPO_PATH/Compete com.flasskamp.compete
    scanignore:
      - submodules/flutter/bin/cache
      - submodules/flutter/packages/flutter/pubspec.yaml
      - submodules/flutter/packages/flutter_localizations/pubspec.yaml
      - submodules/flutter/packages/flutter_test/pubspec.yaml
      - submodules/flutter/packages/flutter_web_plugins/pubspec.yaml
    scandelete:
      - submodules/flutter
      - app/.pub-cache
    build:
      - export ORIGINAL_REPO_PATH=/home/christian/Development/Codeberg
      - cd ../..
      - mv com.flasskamp.compete $ORIGINAL_REPO_PATH/Compete
      - pushd $ORIGINAL_REPO_PATH/Compete/app
      - export PUB_CACHE=$(pwd)/.pub-cache
      - echo "APP_NAME='Compete'" > assets/.env
      - echo "APP_ID='com.flasskamp.compete'" >> assets/.env
      - echo "DEVELOPER_NAME='Christian Flaßkamp'" >> assets/.env
      - echo "REPO_URL='https://codeberg.org/epinez/Compete'" >> assets/.env
      - echo "ISSUE_URL='https://codeberg.org/epinez/Compete/issues'" >> assets/.env
      - echo "CONTACT_EMAIL='compete@flasskamp.com'" >> assets/.env
      - ../submodules/flutter/bin/dart run build_runner build --delete-conflicting-outputs
      - ../submodules/flutter/bin/flutter build apk --split-per-abi --target-platform="android-x64"
      - popd
      - mv $ORIGINAL_REPO_PATH/Compete com.flasskamp.compete

AllowedAPKSigningKeys: a2fdf47278740e26baad8a1dce96cd75b94fa25f9ba17014167d6c2d9ea512a8

AutoUpdateMode: Version
UpdateCheckMode: Tags
VercodeOperation:
  - '%c * 10 + 1'
  - '%c * 10 + 2'
  - '%c * 10 + 3'
UpdateCheckData: app/pubspec.yaml|version:\s.+\+(\d+)|.|version:\s(.+)\+
CurrentVersion: 1.0.2
CurrentVersionCode: 33
