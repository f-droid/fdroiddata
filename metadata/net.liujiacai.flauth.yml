Categories:
  - Password & 2FA
  - Security
License: MIT
AuthorName: Jiacai Liu
AuthorEmail: dev@liujiacai.net
WebSite: https://jiacai2050.github.io/flauth/
SourceCode: https://github.com/jiacai2050/flauth
IssueTracker: https://github.com/jiacai2050/flauth/issues

AutoName: Flauth

RepoType: git
Repo: https://github.com/jiacai2050/flauth
Binaries: https://github.com/jiacai2050/flauth/releases/download/v%v/flauth-android-arm64-v8a-v%v.apk

Builds:
  - versionName: 1.0.0
    versionCode: 2001
    commit: 979f69e489430da468776e61ecc7f16e53dad1fc
    sudo:
      - mkdir -p /home/runner/work/flauth
      - chown -R vagrant /home/runner/
    output: build/app/outputs/flutter-apk/app-arm64-v8a-release.apk
    srclibs:
      - flutter@stable
    rm:
      - ios
      - linux
      - macos
      - windows
      - test
    prebuild:
      - flutterVersion=$(sed -n -E 's/.*flutter-version:[[:space:]]*"(.*)"/\1/p' .github/workflows/release.yml)
      - '[[ $flutterVersion ]]'
      - git -C $$flutter$$ checkout -f $flutterVersion
      - export repo=/home/runner/work/flauth/flauth
      - cd ..
      - mv net.liujiacai.flauth $repo
      - pushd $repo
      - export PUB_CACHE=$(pwd)/.pub-cache
      - $$flutter$$/bin/flutter config --no-analytics
      - $$flutter$$/bin/flutter packages pub get
      - popd
      - mv $repo net.liujiacai.flauth
    scandelete:
      - .pub-cache
    build:
      - export repo=/home/runner/work/flauth/flauth
      - cd ..
      - mv net.liujiacai.flauth $repo
      - pushd $repo
      - export PUB_CACHE=$(pwd)/.pub-cache
      - $$flutter$$/bin/flutter build apk --release --split-per-abi --target-platform="android-arm64"
      - popd
      - mv $repo net.liujiacai.flauth
    ndk: r28c

AllowedAPKSigningKeys: 6f089f1171a04315ff4905956c345e7fcb82a5232387e648c1c6e2af5344b22f

AutoUpdateMode: Version
UpdateCheckMode: Tags ^v[1-9].*
VercodeOperation:
  - '%c + 2000'
UpdateCheckData: pubspec.yaml|version:\s.+\+(\d+)|.|version:\s(.+)\+
CurrentVersion: 1.0.0
CurrentVersionCode: 2001
