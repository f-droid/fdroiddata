Categories:
  - Task
License: GPL-3.0-only
AuthorName: Benoit Brummer
SourceCode: https://codeberg.org/trougnouf/cfait
IssueTracker: https://codeberg.org/trougnouf/cfait/issues
Liberapay: trougnouf
Bitcoin: bc1qc3z9ctv34v0ufxwpmq875r89umnt6ggeclp979
Litecoin: ltc1qv0xcmeuve080j7ad2cj2sd9d22kgqmlxfxvhmg

AutoName: Cfait

RepoType: git
Repo: https://codeberg.org/trougnouf/cfait.git
Binaries: https://codeberg.org/trougnouf/cfait/releases/download/v%v/cfait-android-v%v.apk

Builds:
  - versionName: 0.3.4
    versionCode: 304
    commit: cf37ca56ca0b66dbdb42a09a9056c2981321040c
    subdir: android/app
    sudo:
      - apt-get update
      - apt-get install -y build-essential pkg-config libssl-dev cmake nasm libclang-dev
        make
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
    gradle:
      - yes
    srclibs:
      - rustup@1.28.2
    build:
      - export RUST_VERSION=$(sed -n 's/channel = "\(.*\)"/\1/p' ../../rust-toolchain.toml)
      - $$rustup$$/rustup-init.sh -y --default-toolchain $RUST_VERSION --target aarch64-linux-android
        --target armv7-linux-androideabi --target x86_64-linux-android
      - source $HOME/.cargo/env
      - cargo install --locked cargo-ndk@4.1.2
      - cd ../..
      - export RUSTFLAGS="--remap-path-prefix $(pwd)=/c --remap-path-prefix $HOME/.cargo=/cargo
        -C link-arg=-Wl,--build-id=none"
      - cargo ndk -t aarch64-linux-android -t armv7-linux-androideabi -t x86_64-linux-android
        -o android/app/src/main/jniLibs build --release --lib --features mobile
    ndk: r27d

  - versionName: 0.3.5
    versionCode: 305
    commit: ee64c40a92a2d33fa7736b83edfd7eb2094cdd6f
    subdir: android/app
    sudo:
      - apt-get update
      - apt-get install -y build-essential pkg-config libssl-dev cmake nasm libclang-dev
        make
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
    gradle:
      - yes
    srclibs:
      - rustup@1.28.2
    build:
      - export RUST_VERSION=$(sed -n 's/channel = "\(.*\)"/\1/p' ../../rust-toolchain.toml)
      - $$rustup$$/rustup-init.sh -y --default-toolchain $RUST_VERSION --target aarch64-linux-android
        --target armv7-linux-androideabi --target x86_64-linux-android
      - source $HOME/.cargo/env
      - cargo install --locked cargo-ndk@4.1.2
      - cd ../..
      - export RUSTFLAGS="--remap-path-prefix $(pwd)=/c --remap-path-prefix $HOME/.cargo=/cargo
        -C link-arg=-Wl,--build-id=none"
      - cargo ndk -t aarch64-linux-android -t armv7-linux-androideabi -t x86_64-linux-android
        -o android/app/src/main/jniLibs build --release --lib --features mobile
    ndk: r27d

  - versionName: 0.3.7
    versionCode: 307
    commit: ce5755f72642843b62e50642f27f09fd9e7ccf87
    subdir: android/app
    sudo:
      - apt-get update
      - apt-get install -y build-essential pkg-config libssl-dev cmake nasm libclang-dev
        make
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
    gradle:
      - yes
    srclibs:
      - rustup@1.28.2
    build:
      - export RUST_VERSION=$(sed -n 's/channel = "\(.*\)"/\1/p' ../../rust-toolchain.toml)
      - $$rustup$$/rustup-init.sh -y --default-toolchain $RUST_VERSION --target aarch64-linux-android
        --target armv7-linux-androideabi --target x86_64-linux-android
      - source $HOME/.cargo/env
      - cargo install --locked cargo-ndk@4.1.2
      - cd ../..
      - export RUSTFLAGS="--remap-path-prefix $(pwd)=/c --remap-path-prefix $HOME/.cargo=/cargo
        -C link-arg=-Wl,--build-id=none"
      - cargo ndk -t aarch64-linux-android -t armv7-linux-androideabi -t x86_64-linux-android
        -o android/app/src/main/jniLibs build --release --lib --features mobile
    ndk: r27d

  - versionName: 0.3.8
    versionCode: 308
    commit: 0b0cf1d7e2bbee21763e1a940842ad7f526ecc03
    subdir: android/app
    sudo:
      - apt-get update
      - apt-get install -y build-essential pkg-config libssl-dev cmake nasm libclang-dev
        make
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
    gradle:
      - yes
    srclibs:
      - rustup@1.28.2
    build:
      - export RUST_VERSION=$(sed -n 's/channel = "\(.*\)"/\1/p' ../../rust-toolchain.toml)
      - $$rustup$$/rustup-init.sh -y --default-toolchain $RUST_VERSION --target aarch64-linux-android
        --target armv7-linux-androideabi --target x86_64-linux-android
      - source $HOME/.cargo/env
      - cargo install --locked cargo-ndk@4.1.2
      - cd ../..
      - export RUSTFLAGS="--remap-path-prefix $(pwd)=/c --remap-path-prefix $HOME/.cargo=/cargo
        -C link-arg=-Wl,--build-id=none"
      - cargo ndk -t aarch64-linux-android -t armv7-linux-androideabi -t x86_64-linux-android
        -o android/app/src/main/jniLibs build --release --lib --features mobile
    ndk: r27d

  - versionName: 0.3.10
    versionCode: 310
    commit: 7a375f4a6da3523abe74d59c4472acb318117497
    subdir: android/app
    sudo:
      - apt-get update
      - apt-get install -y build-essential pkg-config libssl-dev cmake nasm libclang-dev
        make
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
    gradle:
      - yes
    srclibs:
      - rustup@1.28.2
    build:
      - export RUST_VERSION=$(sed -n 's/channel = "\(.*\)"/\1/p' ../../rust-toolchain.toml)
      - $$rustup$$/rustup-init.sh -y --default-toolchain $RUST_VERSION --target aarch64-linux-android
        --target armv7-linux-androideabi --target x86_64-linux-android
      - source $HOME/.cargo/env
      - cargo install --locked cargo-ndk@4.1.2
      - cd ../..
      - export RUSTFLAGS="--remap-path-prefix $(pwd)=/c --remap-path-prefix $HOME/.cargo=/cargo
        -C link-arg=-Wl,--build-id=none"
      - cargo ndk -t aarch64-linux-android -t armv7-linux-androideabi -t x86_64-linux-android
        -o android/app/src/main/jniLibs build --release --lib --features mobile
    ndk: r27d

  - versionName: 0.3.12
    versionCode: 312
    commit: 25c5339438e23c198e2f5763f6758cab62307acb
    subdir: android/app
    sudo:
      - apt-get update
      - apt-get install -y build-essential pkg-config libssl-dev cmake nasm libclang-dev
        make
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
    gradle:
      - yes
    srclibs:
      - rustup@1.28.2
    build:
      - export RUST_VERSION=$(sed -n 's/channel = "\(.*\)"/\1/p' ../../rust-toolchain.toml)
      - $$rustup$$/rustup-init.sh -y --default-toolchain $RUST_VERSION --target aarch64-linux-android
        --target armv7-linux-androideabi --target x86_64-linux-android
      - source $HOME/.cargo/env
      - cargo install --locked cargo-ndk@4.1.2
      - cd ../..
      - export RUSTFLAGS="--remap-path-prefix $(pwd)=/c --remap-path-prefix $HOME/.cargo=/cargo
        -C link-arg=-Wl,--build-id=none"
      - cargo ndk -t aarch64-linux-android -t armv7-linux-androideabi -t x86_64-linux-android
        -o android/app/src/main/jniLibs build --release --lib --features mobile
    ndk: r27d

AllowedAPKSigningKeys: 6679a06eec4933fe2933f5be32db3b3e716d42e93c7f230358e779587bab1ac0

AutoUpdateMode: Version
UpdateCheckMode: Tags
UpdateCheckData: Cargo.toml|version_code = (\d+)|.|version = "([\d.]+)"
CurrentVersion: 0.3.12
CurrentVersionCode: 312
