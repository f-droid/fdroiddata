AntiFeatures:
  NonFreeNet:
    en-US: Rely on Bilibili.
Categories:
  - Internet
  - Multimedia
License: Apache-2.0
AuthorName: 萌新杰少
AuthorWebSite: https://imcys.com
SourceCode: https://github.com/1250422131/bilibilias
IssueTracker: https://github.com/1250422131/bilibilias/issues
Changelog: https://github.com/1250422131/bilibilias/releases

AutoName: BILIBILIAS

RepoType: git
Repo: https://github.com/1250422131/bilibilias

Builds:
  - versionName: 2.0.43
    versionCode: 204
    commit: cfe17c0411a76571601ec20ea891a6e2a9f0387a
    subdir: app
    gradle:
      - yes
    prebuild:
      - sed -i -e '/tencent/d' -e '/androidx/d' ../settings.gradle.kts
      - sed -i -e '/mtj/d' ../common/build.gradle.kts
      - sed -i -e '/StatService.onEvent/,/^        )/d' src/main/java/com/imcys/bilibilias/base/utils/*.kt
      - find .. -name *.kt -exec sed -i -e '/StatService/d' {} \;

  - versionName: 2.0.44
    versionCode: 205
    commit: 070929149ad4ea5eaed8eaa4d2920af794cca276
    subdir: app
    gradle:
      - yes
    prebuild:
      - sed -i -e '/tencent/d' -e '/androidx/d' ../settings.gradle.kts
      - sed -i -e '/mtj/d' ../common/build.gradle.kts
      - sed -i -e '/StatService.onEvent/,/^        )/d' src/main/java/com/imcys/bilibilias/base/utils/*.kt
      - find .. -name *.kt -exec sed -i -e '/StatService/d' {} \;

  - versionName: 2.0.45
    versionCode: 206
    commit: 4dff7fbbcffeead83d0d3881bb3782857f08b830
    subdir: app
    gradle:
      - yes
    prebuild:
      - sed -i -e '/tencent/d' -e '/androidx/d' ../settings.gradle.kts
      - sed -i -e '/mtj/d' ../common/build.gradle.kts
      - sed -i -e '/StatService.onEvent/,/^        )/d' src/main/java/com/imcys/bilibilias/base/utils/*.kt
      - find .. -name *.kt -exec sed -i -e '/StatService/d' {} \;
    scandelete:
      - build-logic/convention

  - versionName: 2.0.46
    versionCode: 207
    commit: 104fcac3b6686d89b3cca8b290d9b9b17789f0c5
    subdir: app
    gradle:
      - yes
    prebuild:
      - sed -i -e '/tencent/d' -e '/androidx/d' ../settings.gradle.kts
      - sed -i -e '/mtj/d' ../common/build.gradle.kts
      - sed -i -e '/StatService.onEvent/,/^        )/d' src/main/java/com/imcys/bilibilias/base/utils/*.kt
      - find .. -name *.kt -exec sed -i -e '/StatService/d' {} \;
    scandelete:
      - build-logic/convention

  - versionName: 2.1.0
    versionCode: 210
    commit: b3f51adee25eee5416c1798be17eac06fb9e07af
    subdir: app
    gradle:
      - yes
    rm:
      - common/libs
    prebuild:
      - sed -i -e '/tencent/d' -e '/androidx/d' ../settings.gradle.kts
      - sed -i -e '/Mtj/d' ../common/build.gradle.kts
      - sed -i -e '/StatService.onEvent/,/^        )/d' src/main/java/com/imcys/bilibilias/base/utils/*.kt
      - find .. -name *.kt -exec sed -i -e '/StatService/d' {} \;
    scandelete:
      - build-logic/convention

  - versionName: 2.1.5
    versionCode: 215
    commit: 7891c9a5f5587da5c1efa643bb35bb57f900a899
    subdir: app
    gradle:
      - yes
    rm:
      - common/libs
      - doc
    prebuild:
      - sed -i -e '/foojay/d' ../settings.gradle.kts
      - sed -i -e '/Mtj/d' ../common/build.gradle.kts
      - sed -i -e '/StatService.onEvent/,/^        )/d' src/main/java/com/imcys/bilibilias/base/utils/*.kt
      - find .. -name *.kt -exec sed -i -e '/StatService/d' {} \;
    scandelete:
      - build-logic/convention

  - versionName: 3.1.0
    versionCode: 314
    commit: 2a3c69164c2ed8b42f6a52cb4bb03a0690d2a837
    subdir: app
    submodules: true
    sudo:
      - apt-get update
      - apt-get install -y libc-dev make pkg-config nasm binutils gcc ninja-build
        meson
    gradle:
      - official
    srclibs:
      - FFmpeg@n8.0
    rm:
      - app/src/main/java/com/imcys/bilibilias/common/utils/FirebaseExt.kt
      - app/src/main/java/com/imcys/bilibilias/common/update/GooglePlayAppUpdateManage.kt
    prebuild:
      - sed -i -e '/baidu.jar/d' -e '/baiduJar.isEmpty/,/^    }/d' -e '/googlePlayLibs.forEach/,/^    }/d'
        -e '/DependencyHandlerScope.firebaseDependencies/,/^}/d' -e '/firebaseDependencies/d'
        build.gradle.kts
      - sed -i -e '/firebase/d' {..,.}/build.gradle.kts
      - sed -i -e '/private fun GooglePlayAppUpdateManage/,/^    }/d' -e '/private
        fun initUpdateCheck/,/^    }/d' -e '/initUpdateCheck/d' -e '/GooglePlayAppUpdateManage/d'
        -e '/private fun initFirebase/,/^    }/d' -e '/Firebase/d' src/main/java/com/imcys/bilibilias/MainActivity.kt
      - find .. -name *.kt -exec sed -i -e '/StatService/d' -e '/com.google.firebase/d'
        -e '/FirebaseExt/d' -e '/Firebase/,+1d' {} \;
      - sed -i -e 's|NDK_DIR=".*"|NDK_DIR="$$NDK$$"|' -e 's|FFMPEG_DIR=".*"|FFMPEG_DIR="$$FFmpeg$$"|'
        ../ecology/bilibilias-ffmpeg/build-tools/build-ffmpeg-android.sh
    scandelete:
      - build-logic/convention
    build:
      - SKIP_DEP_INSTALL=1 bash ../ecology/bilibilias-ffmpeg/build-tools/build-ffmpeg-android.sh
      - cp -r ../ecology/bilibilias-ffmpeg/output/ffmpeg ../core/ffmpeg/src/main/cpp
    ndk: r27

AutoUpdateMode: Version
UpdateCheckMode: Tags
CurrentVersion: 3.1.0
CurrentVersionCode: 314
