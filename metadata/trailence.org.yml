AntiFeatures:
  TetheredNet:
    en-US: Rely on trailence.org and openstreetmap.org
  NonFreeNet:
    en-US: Rely on freeipapi.com
Categories:
  - Location Tracker & Sharer
  - Navigation
  - Sports & Health
License: Apache-2.0
AuthorName: Trailence
AuthorEmail: contact@trailence.org
AuthorWebSite: https://trailence.org
WebSite: https://trailence.org
SourceCode: https://github.com/trailence/trailence-front
IssueTracker: https://github.com/trailence/trailence-front/issues
Donate: https://trailence.org/donation

AutoName: Trailence

RepoType: git
Repo: https://github.com/trailence/trailence-front.git
Binaries: https://github.com/trailence/trailence-front/releases/download/%v/trailence-fdroid-%v.apk

Builds:
  - versionName: 1.1.8
    versionCode: 10108
    commit: a171e3bcdf9eef37ca554f9c4f23963a4fbb8288
    subdir: android/app
    sudo:
      - curl -Lo node.tar.gz https://nodejs.org/download/release/v22.20.0/node-v22.20.0-linux-x64.tar.gz
      - echo "eeaccb0378b79406f2208e8b37a62479c70595e20be6b659125eb77dd1ab2a29 node.tar.gz"
        | sha256sum -c -
      - tar xzf node.tar.gz --strip-components=1 -C /usr/local/
      - npm install -g npm@latest
      - npm install -g @ionic/cli @angular/cli
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
    gradle:
      - yes
    prebuild:
      - cd ../..
      - npm ci
      - ionic capacitor sync android --configuration=android-fdroid
      - cd android
      - rm -rf app/src/main/assets/public/{assets/{apk,admin,home-page,mentions-legales.1.html},media}
      - cp -R environments/fdroid/* .
      - sed -i -e 's/8.13.0/8.11.1/' -e '/keys/d' build.gradle
    scandelete:
      - node_modules/
      - e2e/

  - versionName: 1.2.0
    versionCode: 10200
    commit: 887df74d01ee0daf312535d98edd555efa47d955
    subdir: android/app
    sudo:
      - curl -Lo node.tar.gz https://nodejs.org/download/release/v22.20.0/node-v22.20.0-linux-x64.tar.gz
      - echo "eeaccb0378b79406f2208e8b37a62479c70595e20be6b659125eb77dd1ab2a29 node.tar.gz"
        | sha256sum -c -
      - tar xzf node.tar.gz --strip-components=1 -C /usr/local/
      - npm install -g npm@latest
      - npm install -g @ionic/cli @angular/cli
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
    gradle:
      - yes
    prebuild:
      - cd ../..
      - npm ci
      - ionic capacitor sync android --configuration=android-fdroid
      - cd android
      - rm -rf app/src/main/assets/public/{assets/{apk,admin,home-page,mentions-legales.1.html},media}
      - cp -R environments/fdroid/* .
      - sed -i -e 's/8.13.0/8.11.1/' -e '/keys/d' build.gradle
    scandelete:
      - node_modules/
      - e2e/

  - versionName: 1.2.1
    versionCode: 10201
    disable: https://github.com/trailence/trailence-front/issues/458
    commit: 60f0fed6b43d87c00b4af96d771af913c2185796
    subdir: android/app
    sudo:
      - curl -Lo node.tar.gz https://nodejs.org/download/release/v22.20.0/node-v22.20.0-linux-x64.tar.gz
      - echo "eeaccb0378b79406f2208e8b37a62479c70595e20be6b659125eb77dd1ab2a29 node.tar.gz"
        | sha256sum -c -
      - tar xzf node.tar.gz --strip-components=1 -C /usr/local/
      - npm install -g npm@latest
      - npm install -g @ionic/cli @angular/cli
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
    gradle:
      - yes
    prebuild:
      - cd ../..
      - npm ci
      - ionic capacitor sync android --configuration=android-fdroid
      - cd android
      - rm -rf app/src/main/assets/public/{assets/{apk,admin,home-page,mentions-legales.1.html},media}
      - cp -R environments/fdroid/* .
      - sed -i -e '/keys/d' build.gradle
    scandelete:
      - node_modules/
      - e2e/

  - versionName: 1.2.2
    versionCode: 10202
    commit: 56f6ebb22a83941ab2a5a75418f22c9d3717db16
    subdir: android/app
    sudo:
      - curl -Lo node.tar.gz https://nodejs.org/download/release/v22.20.0/node-v22.20.0-linux-x64.tar.gz
      - echo "eeaccb0378b79406f2208e8b37a62479c70595e20be6b659125eb77dd1ab2a29 node.tar.gz"
        | sha256sum -c -
      - tar xzf node.tar.gz --strip-components=1 -C /usr/local/
      - npm install -g npm@latest
      - npm install -g @ionic/cli @angular/cli
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
    gradle:
      - yes
    prebuild:
      - cd ../..
      - npm ci
      - ionic capacitor sync android --configuration=android-fdroid
      - cd android
      - rm -rf app/src/main/assets/public/{assets/{apk,admin,home-page,mentions-legales.1.html},media}
      - cp -R environments/fdroid/* .
      - sed -i -e '/keys/d' build.gradle
    scandelete:
      - node_modules/
      - e2e/

  - versionName: 1.2.3
    versionCode: 10203
    commit: f56118fad3d62d0390c8775cf8b08d6d8422f241
    subdir: android/app
    sudo:
      - curl -Lo node.tar.gz https://nodejs.org/download/release/v22.20.0/node-v22.20.0-linux-x64.tar.gz
      - echo "eeaccb0378b79406f2208e8b37a62479c70595e20be6b659125eb77dd1ab2a29 node.tar.gz"
        | sha256sum -c -
      - tar xzf node.tar.gz --strip-components=1 -C /usr/local/
      - npm install -g npm@latest
      - npm install -g @ionic/cli @angular/cli
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
    gradle:
      - yes
    prebuild:
      - cd ../..
      - npm ci
      - ionic capacitor sync android --configuration=android-fdroid
      - cd android
      - rm -rf app/src/main/assets/public/{assets/{apk,admin,home-page,mentions-legales.1.html},media}
      - cp -R environments/fdroid/* .
      - sed -i -e '/keys/d' build.gradle
    scandelete:
      - node_modules/
      - e2e/

  - versionName: 1.3.0
    versionCode: 10300
    commit: c9366f0a3a150d58290e239ee2a9bc5b4749f6bf
    subdir: android/app
    sudo:
      - curl -Lo node.tar.gz https://nodejs.org/download/release/v22.20.0/node-v22.20.0-linux-x64.tar.gz
      - echo "eeaccb0378b79406f2208e8b37a62479c70595e20be6b659125eb77dd1ab2a29 node.tar.gz"
        | sha256sum -c -
      - tar xzf node.tar.gz --strip-components=1 -C /usr/local/
      - npm install -g npm@latest
      - npm install -g @ionic/cli @angular/cli
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
    gradle:
      - yes
    prebuild:
      - cd ../..
      - npm ci
      - ionic capacitor sync android --configuration=android-fdroid
      - cd android
      - rm -rf app/src/main/assets/public/{assets/{apk,admin,home-page,mentions-legales.1.html},media}
      - cp -R environments/fdroid/* .
      - sed -i -e '/keys/d' build.gradle
    scandelete:
      - node_modules/
      - e2e/

AllowedAPKSigningKeys: e441b156bc74535c82eb1a85521275b470b73855e792a7bde7e9cd454f5dbbc5

AutoUpdateMode: Version
UpdateCheckMode: Tags
UpdateCheckData: android/version.gradle|versionCode\s=\s(\d+)|.|versionName\s=\s'([\d.]+)'
CurrentVersion: 1.3.0
CurrentVersionCode: 10300
