Categories:
  - Connectivity
License: GPL-3.0-or-later
AuthorName: bg443
SourceCode: https://codeberg.org/bg443/JetBird
IssueTracker: https://codeberg.org/bg443/JetBird/issues
Translation: https://translate.codeberg.org/engage/jetbird/
Changelog: https://codeberg.org/bg443/JetBird/releases

AutoName: JetBird

RepoType: git
Repo: https://codeberg.org/bg443/JetBird

Builds:
  - versionName: 1.1.6
    versionCode: 191
    commit: ca713127d5bdca6ebd994ac4223b01b4dc58427f
    subdir: app
    submodules: true
    sudo:
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
      - apt-get install -y -t bookworm-backports golang-go
      - apt-get install -y gcc libc-dev
      - mkdir -p /build
      - chown vagrant /build
    gradle:
      - yes
    output: build/outputs/apk/release/app-armeabi-v7a-release-unsigned.apk
    binary: https://codeberg.org/bg443/JetBird/releases/download/v%v/JetBird-armeabi-v7a-release.apk
    srclibs:
      - go@go1.23.1
    prebuild:
      - sdkmanager "platforms;android-34" "build-tools;34.0.0"
      - sed -i -e 's|-target=android|-target=android/arm|' ../scripts/build_netbird.sh
      - sed -i -e "5a add_compile_options(\"-ffile-prefix-map=$(realpath ..)=/build/repo\")"
        ../jni/CMakeLists.txt
      - GO_VERSION=$(sed -n 's/.*go\(.*\).linux.*/\1/p' ../scripts/init_go.sh)
      - git -C $$go$$ checkout -f go$GO_VERSION
    build:
      - pushd $$go$$/src
      - ./make.bash
      - popd
      - export GOROOT=$$go$$
      - export GOPATH="$HOME/go"
      - export PATH="$GOROOT/bin:$GOPATH/bin:$PATH"
      - GOMOBILE_COMMIT=$(sed -n 's/.*gomobile@\(.*\)/\1/p' ../scripts/init_go.sh)
      - go install golang.org/x/mobile/cmd/gomobile@$GOMOBILE_COMMIT
      - go install golang.org/x/mobile/cmd/gobind@$GOMOBILE_COMMIT
      - cd ../..
      - mv dev.bg.jetbird /build/repo
      - pushd /build/repo
      - ./scripts/build_netbird.sh
      - popd
      - mv /build/repo dev.bg.jetbird
    ndk: r27b

  - versionName: 1.1.6
    versionCode: 192
    commit: ca713127d5bdca6ebd994ac4223b01b4dc58427f
    subdir: app
    submodules: true
    sudo:
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
      - apt-get install -y -t bookworm-backports golang-go
      - apt-get install -y gcc libc-dev
      - mkdir -p /build
      - chown vagrant /build
    gradle:
      - yes
    output: build/outputs/apk/release/app-arm64-v8a-release-unsigned.apk
    binary: https://codeberg.org/bg443/JetBird/releases/download/v%v/JetBird-arm64-v8a-release.apk
    srclibs:
      - go@go1.23.1
    prebuild:
      - sdkmanager "platforms;android-34" "build-tools;34.0.0"
      - sed -i -e 's|-target=android|-target=android/arm64|' ../scripts/build_netbird.sh
      - sed -i -e "5a add_compile_options(\"-ffile-prefix-map=$(realpath ..)=/build/repo\")"
        ../jni/CMakeLists.txt
      - GO_VERSION=$(sed -n 's/.*go\(.*\).linux.*/\1/p' ../scripts/init_go.sh)
      - git -C $$go$$ checkout -f go$GO_VERSION
    build:
      - pushd $$go$$/src
      - ./make.bash
      - popd
      - export GOROOT=$$go$$
      - export GOPATH="$HOME/go"
      - export PATH="$GOROOT/bin:$GOPATH/bin:$PATH"
      - GOMOBILE_COMMIT=$(sed -n 's/.*gomobile@\(.*\)/\1/p' ../scripts/init_go.sh)
      - go install golang.org/x/mobile/cmd/gomobile@$GOMOBILE_COMMIT
      - go install golang.org/x/mobile/cmd/gobind@$GOMOBILE_COMMIT
      - cd ../..
      - mv dev.bg.jetbird /build/repo
      - pushd /build/repo
      - ./scripts/build_netbird.sh
      - popd
      - mv /build/repo dev.bg.jetbird
    ndk: r27b

  - versionName: 1.1.6
    versionCode: 193
    commit: ca713127d5bdca6ebd994ac4223b01b4dc58427f
    subdir: app
    submodules: true
    sudo:
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
      - apt-get install -y -t bookworm-backports golang-go
      - apt-get install -y gcc libc-dev
      - mkdir -p /build
      - chown vagrant /build
    gradle:
      - yes
    output: build/outputs/apk/release/app-x86-release-unsigned.apk
    binary: https://codeberg.org/bg443/JetBird/releases/download/v%v/JetBird-x86-release.apk
    srclibs:
      - go@go1.23.1
    prebuild:
      - sdkmanager "platforms;android-34" "build-tools;34.0.0"
      - sed -i -e 's|-target=android|-target=android/386|' ../scripts/build_netbird.sh
      - sed -i -e "5a add_compile_options(\"-ffile-prefix-map=$(realpath ..)=/build/repo\")"
        ../jni/CMakeLists.txt
      - GO_VERSION=$(sed -n 's/.*go\(.*\).linux.*/\1/p' ../scripts/init_go.sh)
      - git -C $$go$$ checkout -f go$GO_VERSION
    build:
      - pushd $$go$$/src
      - ./make.bash
      - popd
      - export GOROOT=$$go$$
      - export GOPATH="$HOME/go"
      - export PATH="$GOROOT/bin:$GOPATH/bin:$PATH"
      - GOMOBILE_COMMIT=$(sed -n 's/.*gomobile@\(.*\)/\1/p' ../scripts/init_go.sh)
      - go install golang.org/x/mobile/cmd/gomobile@$GOMOBILE_COMMIT
      - go install golang.org/x/mobile/cmd/gobind@$GOMOBILE_COMMIT
      - cd ../..
      - mv dev.bg.jetbird /build/repo
      - pushd /build/repo
      - ./scripts/build_netbird.sh
      - popd
      - mv /build/repo dev.bg.jetbird
    ndk: r27b

  - versionName: 1.1.6
    versionCode: 194
    commit: ca713127d5bdca6ebd994ac4223b01b4dc58427f
    subdir: app
    submodules: true
    sudo:
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
      - apt-get install -y -t bookworm-backports golang-go
      - apt-get install -y gcc libc-dev
      - mkdir -p /build
      - chown vagrant /build
    gradle:
      - yes
    output: build/outputs/apk/release/app-x86_64-release-unsigned.apk
    binary: https://codeberg.org/bg443/JetBird/releases/download/v%v/JetBird-x86_64-release.apk
    srclibs:
      - go@go1.23.1
    prebuild:
      - sdkmanager "platforms;android-34" "build-tools;34.0.0"
      - sed -i -e 's|-target=android|-target=android/amd64|' ../scripts/build_netbird.sh
      - sed -i -e "5a add_compile_options(\"-ffile-prefix-map=$(realpath ..)=/build/repo\")"
        ../jni/CMakeLists.txt
      - GO_VERSION=$(sed -n 's/.*go\(.*\).linux.*/\1/p' ../scripts/init_go.sh)
      - git -C $$go$$ checkout -f go$GO_VERSION
    build:
      - pushd $$go$$/src
      - ./make.bash
      - popd
      - export GOROOT=$$go$$
      - export GOPATH="$HOME/go"
      - export PATH="$GOROOT/bin:$GOPATH/bin:$PATH"
      - GOMOBILE_COMMIT=$(sed -n 's/.*gomobile@\(.*\)/\1/p' ../scripts/init_go.sh)
      - go install golang.org/x/mobile/cmd/gomobile@$GOMOBILE_COMMIT
      - go install golang.org/x/mobile/cmd/gobind@$GOMOBILE_COMMIT
      - cd ../..
      - mv dev.bg.jetbird /build/repo
      - pushd /build/repo
      - ./scripts/build_netbird.sh
      - popd
      - mv /build/repo dev.bg.jetbird
    ndk: r27b

AllowedAPKSigningKeys: 3956533c542218349b5f3f7f3d3a6926060c1a0cdf32d6e58ea1de3a36c21213

AutoUpdateMode: Version
UpdateCheckMode: Tags
VercodeOperation:
  - 10 * %c + 1
  - 10 * %c + 2
  - 10 * %c + 3
  - 10 * %c + 4
CurrentVersion: 1.1.6
CurrentVersionCode: 194
