AntiFeatures:
  NonFreeNet:
    en-US: The backend is proprietary. In order to do progressive rollout of new features,
      the app connects to the proprietary backend to detect whether the experimental
      features are enabled or not.
  Tracking:
    en-US: Users are fingerprinted even if not using the online features.
Categories:
  - Password & 2FA
  - Security
License: GPL-3.0-or-later
AuthorName: Proton
WebSite: https://proton.me/authenticator
SourceCode: https://github.com/protonpass/android-authenticator
Translation: https://proton.me/blog/translation-community
Changelog: https://github.com/protonpass/android-authenticator/blob/HEAD/CHANGELOG.md

AutoName: Proton Auth

RepoType: git
Repo: https://github.com/protonpass/android-authenticator.git

Builds:
  - versionName: 1.3.4
    versionCode: 10304000
    commit: a4f4525f8a49a41eeb0420ec3c9964f35b80ccdf
    subdir: app
    sudo:
      - apt-get update
      - apt-get install -y make golang-go
    gradle:
      - fdroid
      - prod
    srclibs:
      - proton-gomobile-build-tool@9375f8893b85718f717e0b465a156e27c491d1e9
      - protoncore@e87ee6de512763d4b530d6097d3329ffb81ca6e8
    prebuild:
      - sed -i -e 's/+ jobId//' ../platform/build-logic/src/main/kotlin/proton/android/authenticator/platform/buildlogic/domain/platform/configuration/PlatformAndroidConfig.kt
      - echo -e "\norg.gradle.configuration-cache=false" >> ../gradle.properties
      - sed -i -e 's/+ jobId//' build.gradle.kts
      - sed -i -e '/plugins {/,/^}/d' -e '/includeCoreBuild {/,/^}/d' ../settings.gradle.kts
      - sed -i -e '/signingConfigs/d' -e '/signingConfig/,/}$/d' build.gradle.kts
      - sed -i -e '/io.sentry.android.gradle/d' build.gradle.kts
      - sed -i -e '/sentry {/,/^}/d' build.gradle.kts
      - sed -i -e 's_System.getenv().containsKey("CI")_true_g' ../build.gradle.kts
      - sed -i -e 's|../../proton-libs/gopenpgp/gopenpgp.aar|libs/gopenpgp.aar|' build.gradle.kts
      - sed -i -e 's|../proton-libs/gopenpgp/gopenpgp.aar|app/libs/gopenpgp.aar|'
        ../business/keys/build.gradle.kts
      - sed -i -E -e "/go_version/s/[0-9.]+/$(go version | sed -n -E 's/.*go([0-9.]+).*/\1/p')/"
        $$protoncore$$/gopenpgp/build-config.json
    scandelete:
      - platform/build-logic/build
    build:
      - sdkmanager 'platforms;android-36' 'platforms;android-35' 'build-tools;35.0.0'
      - mkdir libs
      - pushd $$proton-gomobile-build-tool$$
      - make build cfg=$$protoncore$$/gopenpgp/build-config.json
      - popd
      - mv $$proton-gomobile-build-tool$$/out/android/gopenpgp.aar libs
    ndk: 23.2.8568313
    gradleprops:
      - apkBuild=true

  - versionName: 1.3.5
    versionCode: 10305000
    commit: 37cdcf6556cd0f0e8b147038d59f68c9ee93c765
    subdir: app
    sudo:
      - apt-get update
      - apt-get install -y make golang-go
    gradle:
      - fdroid
      - prod
    srclibs:
      - proton-gomobile-build-tool@9375f8893b85718f717e0b465a156e27c491d1e9
      - protoncore@e87ee6de512763d4b530d6097d3329ffb81ca6e8
    prebuild:
      - sed -i -e 's/+ jobId//' ../platform/build-logic/src/main/kotlin/proton/android/authenticator/platform/buildlogic/domain/platform/configuration/PlatformAndroidConfig.kt
      - echo -e "\norg.gradle.configuration-cache=false" >> ../gradle.properties
      - sed -i -e 's/+ jobId//' build.gradle.kts
      - sed -i -e '/plugins {/,/^}/d' -e '/includeCoreBuild {/,/^}/d' ../settings.gradle.kts
      - sed -i -e '/signingConfigs/d' -e '/signingConfig/,/}$/d' build.gradle.kts
      - sed -i -e '/io.sentry.android.gradle/d' build.gradle.kts
      - sed -i -e '/sentry {/,/^}/d' build.gradle.kts
      - sed -i -e 's_System.getenv().containsKey("CI")_true_g' ../build.gradle.kts
      - sed -i -e 's|../../proton-libs/gopenpgp/gopenpgp.aar|libs/gopenpgp.aar|' build.gradle.kts
      - sed -i -e 's|../proton-libs/gopenpgp/gopenpgp.aar|app/libs/gopenpgp.aar|'
        ../business/keys/build.gradle.kts
      - sed -i -E -e "/go_version/s/[0-9.]+/$(go version | sed -n -E 's/.*go([0-9.]+).*/\1/p')/"
        $$protoncore$$/gopenpgp/build-config.json
    scandelete:
      - platform/build-logic/build
    build:
      - sdkmanager 'platforms;android-36' 'platforms;android-35' 'build-tools;35.0.0'
      - mkdir libs
      - pushd $$proton-gomobile-build-tool$$
      - make build cfg=$$protoncore$$/gopenpgp/build-config.json
      - popd
      - mv $$proton-gomobile-build-tool$$/out/android/gopenpgp.aar libs
    ndk: 23.2.8568313
    gradleprops:
      - apkBuild=true

MaintainerNotes: The protoncore library should only be needed when building the gopenpgp
  library, and the exact tag should not matter.

AutoUpdateMode: Version
UpdateCheckMode: Tags
UpdateCheckData: metadata/fdroid_version.txt|versionCode=(\d+)|.|versionName=(.*)
CurrentVersion: 1.3.5
CurrentVersionCode: 10305000
