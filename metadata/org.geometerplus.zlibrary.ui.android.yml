AntiFeatures:
  NonFreeAdd:
    en-US: App suggests non-libre dictionaries.
  UpstreamNonFree:
    en-US: Some non-free 3rd-party libraries were removed.
Categories:
  - Reading
License: GPL-2.0-or-later
AuthorName: Nikolay Pultsin
AuthorEmail: geometer@fbreader.org
AuthorWebSite: https://fbreader.org/
WebSite: https://fbreader.org/FBReaderJ
SourceCode: https://github.com/geometer/FBReaderJ
IssueTracker: https://github.com/geometer/FBReaderJ/issues
Changelog: https://raw.githubusercontent.com/geometer/FBReaderJ/HEAD/ChangeLog
Donate: https://fbreader.org/donation/make.php

AutoName: FBReader
Description: |-
  <b>N.B</b>There are three different apks to cover the different versions of
  Android. Donut covers 1.5-1.6; Froyo covers 2.0-2.3 and Honeycomb covers 3.0+.
  x86 and MIPS are supported natively in all apks.

  An e-book reader. Features include the ability to stock up on books from online
  OPDS libraries like Project Gutenberg straight from the app. F-Droid.org has two
  other addon apps that provide text-to-speech functionality and one to support
  <i>local</i> OPDS shares.

  Anti-features: Addons. While there are some addons for this app that are free,
  the dictionaries that are suggested are not. However, it does support
  https://f-droid.org/packages/aarddict.android, as long as that is installed beforehand <b>and</b> you
  choose it via the Dictionary section of the settings.

RepoType: git
Repo: https://github.com/geometer/FBReaderJ.git

Builds:
  - versionName: 0.99.11
    versionCode: 9911
    commit: 0.99.11
    antcommands:
      - package

  - versionName: 0.99.12
    versionCode: 9912
    commit: 0.99.12
    antcommands:
      - package

  - versionName: 0.99.15
    versionCode: 9915
    commit: 0.99.15
    antcommands:
      - package

  - versionName: 0.99.18
    versionCode: 9918
    commit: 0.99.18
    antcommands:
      - package

  - versionName: 1.0.9
    versionCode: 10011
    commit: 1.0.9
    antcommands:
      - package

  - versionName: 1.0.11
    versionCode: 10013
    commit: 1.0.11
    antcommands:
      - package

  - versionName: 1.0.12
    versionCode: 10014
    commit: fd349108eff9caa9152ad1eafed0a1faa76b3ce3
    antcommands:
      - package

  - versionName: 1.1.0
    versionCode: 10100
    commit: 5eb993e1fac2898d23619c27ebad593d7ecd2089
    antcommands:
      - package

  - versionName: 1.1.1
    versionCode: 10101
    commit: 1.1.1
    antcommands:
      - package

  - versionName: 1.1.2
    versionCode: 10102
    commit: 1.1.2
    antcommands:
      - package

  - versionName: 1.1.8
    versionCode: 101081
    commit: 1.1.8
    antcommands:
      - package

  - versionName: 1.1.9
    versionCode: 101091
    commit: 1.1.9
    antcommands:
      - package

  - versionName: 1.1.10
    versionCode: 101101
    commit: 13ee5d79431815dd694ec409ebdc547ca7758f05
    antcommands:
      - package

  - versionName: 1.2.2
    versionCode: 102021
    commit: e63c553aeb032da828b270a735f0171d8d22c54c
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    target: android-10
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.2.3
    versionCode: 102031
    commit: 46d83bb4351c2f6ec51e0d9aa6202c86c1297e7f
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    target: android-10
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.2.4
    versionCode: 102041
    commit: 6426bcf131d458e77030a07d0b55e10270d78081
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    target: android-10
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.2.6
    versionCode: 102061
    commit: 1.2.6
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    target: android-10
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.3.3
    versionCode: 103031
    commit: 1.3.3
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    target: android-10
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.3.6
    versionCode: 103061
    commit: a16e3eb7ff731edea99248f8a7c1633148a26236
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    target: android-10
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.5.5
    versionCode: 105051
    commit: 1.5.5
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    target: android-10
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.6.1
    versionCode: 106011
    commit: 1.6.1
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.6.4-Donut
    versionCode: 106040
    commit: af881fe3722a86104d1419b4bb2205e154f78efe
    forceversion: true
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.6.4-Froyo
    versionCode: 106041
    commit: 696ed77046d95930325f61f92f5a46ecc988ac26
    forceversion: true
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.6.4
    versionCode: 106042
    commit: b3b4667ccb0faa5f86a2743fe476500efb56b19f
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.7.2-Donut
    versionCode: 107019
    commit: a4a5e506b5a63a0d93349ef626700ff2e5d7ea7b
    forceversion: true
    forcevercode: true
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.7.2-Froyo
    versionCode: 107020
    commit: 33ffc7e5b72c3039b077418e2273d03d6b7a9fe3
    forceversion: true
    forcevercode: true
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.7.2-Honeycomb
    versionCode: 107021
    commit: 05201596778f490460942b425073d98912044d67
    forceversion: true
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.7.3-Donut
    versionCode: 107040
    commit: 2c6253ddd6b2791a949b209311738a7a4c776a5b
    forceversion: true
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.7.3-Froyo
    versionCode: 107041
    commit: 934bf7f53b923ce128bd64e6e94689c256b271cc
    forceversion: true
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.7.3-Honeycomb
    versionCode: 107042
    commit: c4a3c7a9a707aa062e4a80c301530b2695e857d5
    forceversion: true
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.7.8-Donut
    versionCode: 107080
    commit: c1470c9be1bd9bf63a4d1d09b9baf4e4f08a5081
    forceversion: true
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.7.8-Froyo
    versionCode: 107084
    commit: 1.7.8
    forceversion: true
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.7.8-Honeycomb
    versionCode: 107085
    commit: 1.7.8-ics
    forceversion: true
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.8.2-Donut
    versionCode: 108020
    commit: 9bec0ff445e66a44060c39d265ae4bcd2677f003
    forceversion: true
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    androidupdate:
      - third-party/AmbilWarna
      - .
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.8.2-Froyo
    versionCode: 108021
    commit: 0f02d4e923222734597c24d3c182f196065ba8ec
    forceversion: true
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    androidupdate:
      - third-party/AmbilWarna
      - .
    buildjni:
      - yes
    ndk: r12b

  - versionName: 1.8.2-Honeycomb+
    versionCode: 108022
    commit: 1112df415d57d0df8fe2eb707fff66dd723a0c50
    forceversion: true
    prebuild:
      - mkdir res/drawable
      - find icons -iname "*.*" -exec cp {} res/drawable \;
    androidupdate:
      - third-party/AmbilWarna
      - .
    buildjni:
      - yes
    ndk: r12b

  - versionName: 2.0.6-ics
    versionCode: 2000620
    commit: b1dd70ff149560889e7548762046da4933e51e94
    patch:
      - fbreader-2.0.6.patch
    srclibs:
      - FBReaderJ@2.0.6
      - PDFParseLib@36d7479ce85638eb4f0ff9c875ec77680177da5d
      - ApacheHttpClient@4.2.5
      - NanoHttpd@Release-2.0.5
      - JsonSimple@tag_release_1_1_1
    forceversion: true
    rm:
      - libs/*jar
      - obsolete/lib/*.jar
    prebuild:
      - echo -e "sdk.dir=$$SDK$$\nndk.dir=$$NDK$$\n" >> local.properties
      - cp local.properties third-party/AmbilWarna/
      - cp local.properties third-party/android-filechooser/code/
      - cp local.properties third-party/drag-sort-listview/library/
      - pushd $$ApacheHttpClient$$/httpmime/
      - mvn package
      - popd
      - cp $$ApacheHttpClient$$/httpmime/target/httpmime-4.2.5.jar libs/
      - pushd $$NanoHttpd$$
      - mvn package
      - popd
      - cp $$NanoHttpd$$/core/target/nanohttpd-2.0.5.jar libs/
      - cp -fR $$JsonSimple$$/src/main/java/org src/
      - cp -fR $$PDFParseLib$$/pdfparse-lib/src/main/java/org src/
      - rm -fR src/com/paragon
      - sed -i -e '/com.google.android.gms.version/d' -e '/google_play_services/d'  AndroidManifest.xml
      - sed -i -e '/google.services.lib.dir/d' project.properties
      - rm -fR src/org/geometerplus/android/fbreader/network/auth
      - cp -fR $$FBReaderJ$$/src/org/geometerplus/android/fbreader/network/auth src/org/geometerplus/android/fbreader/network/
    androidupdate:
      - third-party/AmbilWarna
      - third-party/android-filechooser/code
      - third-party/drag-sort-listview/library
      - .
    target: android-14
    buildjni:
      - yes
    ndk: r12b

  - versionName: 2.1-ics
    versionCode: 2010020
    commit: 33139e2b04ae36388956a57373ba74e8cc0ef23c
    patch:
      - fbreader-2.0.6.patch
    srclibs:
      - FBReaderJ@2.1
      - PDFParseLib@36d7479ce85638eb4f0ff9c875ec77680177da5d
      - ApacheHttpClient@4.2.5
      - NanoHttpd@Release-2.0.5
      - JsonSimple@tag_release_1_1_1
    forceversion: true
    rm:
      - libs/*jar
      - obsolete/lib/*.jar
    prebuild:
      - echo -e "sdk.dir=$$SDK$$\nndk.dir=$$NDK$$\n" >> local.properties
      - cp local.properties third-party/AmbilWarna/
      - cp local.properties third-party/android-filechooser/code/
      - cp local.properties third-party/drag-sort-listview/library/
      - pushd $$ApacheHttpClient$$/httpmime/
      - mvn package
      - popd
      - cp $$ApacheHttpClient$$/httpmime/target/httpmime-4.2.5.jar libs/
      - pushd $$NanoHttpd$$
      - mvn package
      - popd
      - cp $$NanoHttpd$$/core/target/nanohttpd-2.0.5.jar libs/
      - cp -fR $$JsonSimple$$/src/main/java/org src/
      - cp -fR $$PDFParseLib$$/pdfparse-lib/src/main/java/org src/
      - rm -fR src/com/paragon
      - sed -i -e '/com.google.android.gms.version/d' -e '/google_play_services/d'  AndroidManifest.xml
      - sed -i -e '/google.services.lib.dir/d' project.properties
      - rm -fR src/org/geometerplus/android/fbreader/network/auth
      - cp -fR $$FBReaderJ$$/src/org/geometerplus/android/fbreader/network/auth src/org/geometerplus/android/fbreader/network/
    androidupdate:
      - third-party/AmbilWarna
      - third-party/android-filechooser/code
      - third-party/drag-sort-listview/library
      - .
    target: android-14
    buildjni:
      - yes
    ndk: r12b

  - versionName: 2.5.9-ics
    versionCode: 2050920
    commit: 43e14feedf10ad53ec68bf42b1644f488889381c
    srclibs:
      - FBReaderJ@2.5.9
      - PDFParseLib@36d7479ce85638eb4f0ff9c875ec77680177da5d
      - ApacheHttpClient@4.2.5
      - NanoHttpd@Release-2.0.5
      - JsonSimple@tag_release_1_1_1
    forceversion: true
    rm:
      - libs/*jar
      - obsolete/lib/*.jar
      - src/org/geometerplus/android/fbreader/dict/OpenDictionary.java
      - src/org/geometerplus/android/fbreader/dict/Lingvo.java
    extlibs:
      - android/android-support-v4.jar
    prebuild:
      - echo -e "sdk.dir=$$SDK$$\nndk.dir=$$NDK$$\n" >> local.properties
      - cp local.properties third-party/AmbilWarna/
      - cp local.properties third-party/android-filechooser/code/
      - cp local.properties third-party/drag-sort-listview/library/
      - echo 'APP_PLATFORM := android-11' >> jni/Application.mk
      - pushd $$ApacheHttpClient$$/httpmime/
      - mvn package -Dmaven.javadoc.skip=true
      - popd
      - cp $$ApacheHttpClient$$/httpmime/target/httpmime-4.2.5.jar libs/
      - pushd $$NanoHttpd$$
      - mvn package
      - popd
      - cp $$NanoHttpd$$/core/target/nanohttpd-2.0.5.jar libs/
      - cp -fR $$JsonSimple$$/src/main/java/org src/
      - cp -fR $$PDFParseLib$$/pdfparse-lib/src/main/java/org src/
      - rm -fR src/com/paragon
      - sed -i -e '/com.google.android.gms.version/d' -e '/google_play_services/d'  AndroidManifest.xml
      - sed -i -e '/google.services.lib.dir/d' project.properties
      - mkdir third-party/drag-sort-listview/library/libs
      - cp libs/android-support-v4.jar third-party/drag-sort-listview/library/libs/&&
        sed -i -e '/Lingvo/d' src/org/geometerplus/android/fbreader/dict/DictionaryUtil.java
      - rm -fR src/org/geometerplus/android/fbreader/network/auth
      - cp -fR $$FBReaderJ$$/src/org/geometerplus/android/fbreader/network/auth src/org/geometerplus/android/fbreader/network/
      - sed -i -e '/^\s*OpenDictionary.collect/d' src/org/geometerplus/android/fbreader/dict/DictionaryUtil.java
    androidupdate:
      - third-party/AmbilWarna
      - third-party/android-filechooser/code
      - third-party/drag-sort-listview/library
      - .
    target: android-21
    buildjni:
      - yes
    ndk: r12b

MaintainerNotes: |-
  * LingvoIntegration and OpenDictionary APIs are non-free. Remove jars and patch
    depending code.  Currently done with rm and sed in prebuilds.
  * %v tags are currently targeting gingerbread, but have ressource conflicts
    with target=android-9; they build with target=android-14
  * %v-ics tags are actually based on the yotaphone branch, so we have to
    use raw commits for the ice-cream-sandwich branch (look for "Merge
    branch 'master' into ice-cream-sandwich" after a commit with "version
    => ...")
  * ics branch uses google play, so we have to sed AM.xml and ant files.
    /fbreader/network/ depends on Google Play Services, so these are
    removed and replaced with the master branch which does not depend on
    these.
  * UCM is set to master branch, we don't care for target or device specific
    releases.

  TODO:
  * make gingerbread/master available for android-9!

ArchivePolicy: 0
AutoUpdateMode: None
UpdateCheckMode: None
VercodeOperation:
  - '%c + 10'
CurrentVersion: 2.5.9
CurrentVersionCode: 2050920

NoSourceSince: 2.5.9
