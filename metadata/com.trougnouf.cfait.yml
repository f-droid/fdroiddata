Categories:
  - Task
License: GPL-3.0-only
AuthorName: Benoit Brummer
SourceCode: https://codeberg.org/trougnouf/cfait
IssueTracker: https://codeberg.org/trougnouf/cfait/issues
Liberapay: trougnouf
Bitcoin: bc1qc3z9ctv34v0ufxwpmq875r89umnt6ggeclp979
Litecoin: ltc1qv0xcmeuve080j7ad2cj2sd9d22kgqmlxfxvhmg

AutoName: Cfait

RepoType: git
Repo: https://codeberg.org/trougnouf/cfait.git
Binaries: https://codeberg.org/trougnouf/cfait/releases/download/v%v/cfait-android-v%v.apk

Builds:
  - versionName: 0.4.5
    versionCode: 405
    commit: 5b2527db6d5c91b27de7d80f8506da2bdb7d07b6
    subdir: android/app
    sudo:
      - apt-get update
      - apt-get install -y build-essential pkg-config libssl-dev cmake nasm libclang-dev
        make
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
    gradle:
      - yes
    srclibs:
      - rustup@1.28.2
    build:
      - export RUST_VERSION=$(sed -n 's/channel = "\(.*\)"/\1/p' ../../rust-toolchain.toml)
      - $$rustup$$/rustup-init.sh -y --default-toolchain $RUST_VERSION --target aarch64-linux-android
        --target armv7-linux-androideabi --target x86_64-linux-android
      - source $HOME/.cargo/env
      - cargo install --locked cargo-ndk@4.1.2
      - cd ../..
      - export RUSTFLAGS="--remap-path-prefix $(pwd)=/c --remap-path-prefix $HOME/.cargo=/cargo
        -C link-arg=-Wl,--build-id=none"
      - cargo ndk -t aarch64-linux-android -t armv7-linux-androideabi -t x86_64-linux-android
        -o android/app/src/main/jniLibs build --release --lib --features mobile
    ndk: r27d

  - versionName: 0.4.6
    versionCode: 406
    commit: 20dee3e7fd9b449d0af73d871d9dc07918bb262d
    subdir: android/app
    sudo:
      - apt-get update
      - apt-get install -y build-essential pkg-config libssl-dev cmake nasm libclang-dev
        make
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
    gradle:
      - yes
    srclibs:
      - rustup@1.28.2
    build:
      - export RUST_VERSION=$(sed -n 's/channel = "\(.*\)"/\1/p' ../../rust-toolchain.toml)
      - $$rustup$$/rustup-init.sh -y --default-toolchain $RUST_VERSION --target aarch64-linux-android
        --target armv7-linux-androideabi --target x86_64-linux-android
      - source $HOME/.cargo/env
      - cargo install --locked cargo-ndk@4.1.2
      - cd ../..
      - export RUSTFLAGS="--remap-path-prefix $(pwd)=/c --remap-path-prefix $HOME/.cargo=/cargo
        -C link-arg=-Wl,--build-id=none"
      - cargo ndk -t aarch64-linux-android -t armv7-linux-androideabi -t x86_64-linux-android
        -o android/app/src/main/jniLibs build --release --lib --features mobile
    ndk: r27d

  - versionName: 0.4.7
    versionCode: 407
    commit: f42f162ee89feb7fbca1ccbb214b2a3f4ab79d85
    subdir: android/app
    sudo:
      - apt-get update
      - apt-get install -y build-essential pkg-config libssl-dev cmake nasm libclang-dev
        make
      - echo "deb https://deb.debian.org/debian trixie main" > /etc/apt/sources.list.d/trixie.list
      - apt-get update
      - apt-get install -y -t trixie openjdk-21-jdk-headless
      - update-alternatives --auto java
    gradle:
      - yes
    srclibs:
      - rustup@1.28.2
    build:
      - export RUST_VERSION=$(sed -n 's/channel = "\(.*\)"/\1/p' ../../rust-toolchain.toml)
      - $$rustup$$/rustup-init.sh -y --default-toolchain $RUST_VERSION --target aarch64-linux-android
        --target armv7-linux-androideabi --target x86_64-linux-android
      - source $HOME/.cargo/env
      - cargo install --locked cargo-ndk@4.1.2
      - cd ../..
      - export RUSTFLAGS="--remap-path-prefix $(pwd)=/c --remap-path-prefix $HOME/.cargo=/cargo
        -C link-arg=-Wl,--build-id=none"
      - cargo ndk -t aarch64-linux-android -t armv7-linux-androideabi -t x86_64-linux-android
        -o android/app/src/main/jniLibs build --release --lib --features mobile
    ndk: r27d

  - versionName: 0.4.8
    versionCode: 408
    commit: b9d839e1dee5d9cb0792fac97c1bb7ecb5244f21
    subdir: android/app
    sudo:
      - apt-get update
      - apt-get install -y build-essential pkg-config libssl-dev cmake nasm libclang-dev
        make
    gradle:
      - yes
    srclibs:
      - rustup@1.28.2
    build:
      - export RUST_VERSION=$(sed -n 's/channel = "\(.*\)"/\1/p' ../../rust-toolchain.toml)
      - $$rustup$$/rustup-init.sh -y --default-toolchain $RUST_VERSION --target aarch64-linux-android
        --target armv7-linux-androideabi --target x86_64-linux-android
      - source $HOME/.cargo/env
      - cargo install --locked cargo-ndk@4.1.2
      - cd ../..
      - export RUSTFLAGS="--remap-path-prefix $(pwd)=/c --remap-path-prefix $HOME/.cargo=/cargo
        -C link-arg=-Wl,--build-id=none"
      - cargo ndk -t aarch64-linux-android -t armv7-linux-androideabi -t x86_64-linux-android
        -o android/app/src/main/jniLibs build --release --lib --features mobile --platform
        28
    ndk: r27d

  - versionName: 0.4.9
    versionCode: 409
    commit: f8e94eccb9f53bc635783df9ec4ccffe7ca1c658
    subdir: android/app
    sudo:
      - apt-get update
      - apt-get install -y build-essential pkg-config libssl-dev cmake nasm libclang-dev
        make
    gradle:
      - yes
    srclibs:
      - rustup@1.28.2
    build:
      - export RUST_VERSION=$(sed -n 's/channel = "\(.*\)"/\1/p' ../../rust-toolchain.toml)
      - $$rustup$$/rustup-init.sh -y --default-toolchain $RUST_VERSION --target aarch64-linux-android
        --target armv7-linux-androideabi --target x86_64-linux-android
      - source $HOME/.cargo/env
      - cargo install --locked cargo-ndk@4.1.2
      - cd ../..
      - export RUSTFLAGS="--remap-path-prefix $(pwd)=/c --remap-path-prefix $HOME/.cargo=/cargo
        -C link-arg=-Wl,--build-id=none"
      - cargo ndk -t aarch64-linux-android -t armv7-linux-androideabi -t x86_64-linux-android
        -o android/app/src/main/jniLibs build --release --lib --features mobile --platform
        28
    ndk: r27d

  - versionName: 0.5.1
    versionCode: 501
    commit: bae9bc3f7768a476656ce4eed740099205356e70
    subdir: android/app
    sudo:
      - apt-get update
      - apt-get install -y build-essential pkg-config libssl-dev cmake nasm libclang-dev
        make
    gradle:
      - yes
    srclibs:
      - rustup@1.28.2
    build:
      - export RUST_VERSION=$(sed -n 's/channel = "\(.*\)"/\1/p' ../../rust-toolchain.toml)
      - $$rustup$$/rustup-init.sh -y --default-toolchain $RUST_VERSION --target aarch64-linux-android
        --target armv7-linux-androideabi --target x86_64-linux-android
      - source $HOME/.cargo/env
      - cargo install --locked cargo-ndk@4.1.2
      - cd ../..
      - export RUSTFLAGS="--remap-path-prefix $(pwd)=/c --remap-path-prefix $HOME/.cargo=/cargo
        -C link-arg=-Wl,--build-id=none"
      - cargo ndk -t aarch64-linux-android -t armv7-linux-androideabi -t x86_64-linux-android
        -o android/app/src/main/jniLibs build --release --lib --features mobile --platform
        28
    ndk: r27d

AllowedAPKSigningKeys: 6679a06eec4933fe2933f5be32db3b3e716d42e93c7f230358e779587bab1ac0

AutoUpdateMode: Version
UpdateCheckMode: Tags
UpdateCheckData: Cargo.toml|version_code = (\d+)|.|version = "([\d.]+)"
CurrentVersion: 0.5.1
CurrentVersionCode: 501
